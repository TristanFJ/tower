import{r as P,c as y,a as x,o as m,b as v,d as o,e as E,F as H,S as I,f as M,u as B,g as O,t as _,h as T,i as K,w as N,j as p,v as g,k as z,l as Y,m as D,n as W,p as F,q as R,s as G,x as Q,y as X}from"./vendor.e9603ee6.js";const J=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const r of c.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(s){if(s.ep)return;s.ep=!0;const c=t(s);fetch(s.href,c)}};J();const i=P({user:{},account:{},events:[],activeEvent:{},comments:[],attendees:[],capacity:{},myEvents:[]});var w=(a,e)=>{for(const[t,n]of e)a[t]=n;return a};const Z={name:"App",setup(){return{appState:y(()=>i)}}},ee=o("footer",null,null,-1);function te(a,e,t,n,s,c){const r=x("Navbar"),b=x("router-view");return m(),v(H,null,[o("header",null,[E(r)]),o("main",null,[E(b)]),ee],64)}var ne=w(Z,[["render",te]]);const V=window.location.origin.includes("localhost"),$=V?"http://localhost:3000":"",oe="kylee-marlin.us.auth0.com",ae="mpXgASnPybMqw6Qp3lKxL9QNqXVp7ylk",se="https://CoolStuff.com";function C(a,e){if(V)console[a](`[${a}] :: ${new Date().toLocaleTimeString()} :: `,...e);else{switch(a){case"log":case"assert":return}console[a](`[${a}] :: ${new Date().toLocaleTimeString()} :: `,...e)}}const l={log(){C("log",arguments)},error(){C("error",arguments)},warn(){C("warn",arguments)},assert(){C("assert",arguments)},trace(){C("trace",arguments)}};class h{static async confirm(e="Are you sure?",t="You won't be able to revert this!",n="warning",s="Yes, delete it!"){try{return!!(await I.fire({title:e,text:t,icon:n,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:s})).isConfirmed}catch{return!1}}static toast(e="Warning!",t="warning",n="top-end",s=3e3,c=!0){I.fire({title:e,icon:t,position:n,timer:s,timerProgressBar:c,toast:!0,showConfirmButton:!1})}}const d=M.create({baseURL:$,timeout:8e3});class re{async getAll(e=""){const t=await d.get(e);l.log("comments",t),i.comments=t.data}async createComment(e){h.toast("created","success");const t=await d.post("api/comments",e);i.comments.push(t.data)}async remove(e){!await h.confirm("delete?")||(await d.delete("api/comments/"+e),i.comments=i.comments.filter(n=>n.id!==e))}}const ce=new re,ie={props:{comment:{type:Object,required:!0}},setup(a){const e=B();return{comments:y(()=>i.comments),account:y(()=>i.account),active:y(()=>i.events.find(t=>t.id==e.params.eventId)),async remove(){try{const t=a.comment.id;l.log(t),await ce.remove(t)}catch(t){l.log(t)}}}}},le={class:"comment m-2 border border-dark p-2"},de=["title","src"];function ue(a,e,t,n,s,c){return m(),v("div",le,[o("h5",null,[o("img",{title:t.comment.creator.name,src:t.comment.creator.picture,width:"50",alt:""},null,8,de),O(" "+_(t.comment.creator.name),1),n.account.id==n.active.creatorId?(m(),v("i",{key:0,onClick:e[0]||(e[0]=r=>n.remove()),class:"selectable bg-danger mdi mdi-close rounded-circle align-self-center p-0 m-5",title:"remove"})):T("",!0)]),o("p",null,_(t.comment.body),1)])}var me=w(ie,[["render",ue]]),ve=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:me});class _e{async getAll(e=""){const t=await d.get(e);l.log(t),i.events=t.data}async getMyEvents(){const e=await d.get("account/attendees");l.log(e),i.myEvents=e.data}async createEvent(e){h.toast("created","success");const t=await d.post("api/events",e);i.events.unshift(t.data),i.activeEvent=t.data}async edit(e,t){const n=await d.put("api/events/"+e,t);l.log(n);const s=i.events.findIndex(c=>c.id===n.data.id);i.events.splice(s,1,n.data)}async cancel(e){!await h.confirm("cancel?")||(await d.delete("api/events/"+e),i.events=i.events.filter(n=>n.id!==e),i.activeEvent={})}async attend(e){const t=await d.post("api/attendees/",e);l.log(t),i.attendees.push(t.data)}}const pe=new _e,ge={setup(){const a=K(),e=P({editable:{}});return{state:e,async createEvent(){try{await pe.createEvent(e.editable),e.editable={},a.push({name:"Event",params:{eventId:i.activeEvent.id}})}catch(t){l.error(t),h.toast(t.message,"error")}}}}},he={class:"createEvent text-dark"},be=o("button",{type:"button",class:"btn btn-primary btn-lg","data-bs-toggle":"modal","data-bs-target":"#create"}," Create Event ",-1),fe={class:"modal fade",id:"create",tabindex:"-1",role:"dialog","aria-labelledby":"modelTitleId","aria-hidden":"true"},ye={class:"modal-dialog",role:"document"},Ee={class:"modal-content"},we=o("div",{class:"modal-header"},[o("h5",{class:"modal-title"},"Create New Event"),o("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ce={class:"modal-body"},xe={class:"modal-footer"},Ae=o("button",{class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);function Se(a,e,t,n,s,c){return m(),v("div",he,[be,o("div",fe,[o("div",ye,[o("div",Ee,[we,o("div",Ce,[o("form",{onSubmit:e[8]||(e[8]=N(r=>n.createEvent(),["prevent"]))},[p(o("input",{class:"form-control","onUpdate:modelValue":e[0]||(e[0]=r=>n.state.editable.name=r),type:"text",placeholder:"Event name"},null,512),[[g,n.state.editable.name]]),p(o("input",{class:"form-control","onUpdate:modelValue":e[1]||(e[1]=r=>n.state.editable.description=r),type:"text",placeholder:"Description"},null,512),[[g,n.state.editable.description]]),p(o("input",{class:"form-control","onUpdate:modelValue":e[2]||(e[2]=r=>n.state.editable.coverImg=r),type:"text",placeholder:"coverImg"},null,512),[[g,n.state.editable.coverImg]]),p(o("input",{class:"form-control","onUpdate:modelValue":e[3]||(e[3]=r=>n.state.editable.location=r),type:"text",placeholder:"Location"},null,512),[[g,n.state.editable.location]]),p(o("input",{class:"form-control","onUpdate:modelValue":e[4]||(e[4]=r=>n.state.editable.capacity=r),type:"number",placeholder:"Capacity"},null,512),[[g,n.state.editable.capacity]]),p(o("input",{class:"form-control","onUpdate:modelValue":e[5]||(e[5]=r=>n.state.editable.startDate=r),type:"date",placeholder:"Start date"},null,512),[[g,n.state.editable.startDate]]),p(o("input",{class:"form-control","onUpdate:modelValue":e[6]||(e[6]=r=>n.state.editable.type=r),type:"text",placeholder:"'concert', 'convention', 'sport', 'digital'"},null,512),[[g,n.state.editable.type]]),o("div",xe,[Ae,o("button",{type:"submit",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:e[7]||(e[7]=N(r=>n.createEvent(),["prevent"]))}," Save ")])],32)])])])])])}var ke=w(ge,[["render",Se]]),Te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:ke});const Pe={props:{event:{type:Object,required:!0}},setup(){return{}}},Ie={class:"col-md-3 selectable card m-0 p-1 elevation-3"},Oe=["src"],Ne={key:0,class:"bg-danger"},De={key:1,class:"bg-danger"};function Re(a,e,t,n,s,c){return m(),v("div",Ie,[o("img",{class:"elevation-3",src:t.event.coverImg,alt:""},null,8,Oe),o("h4",null,_(t.event.name),1),o("p",null,"Starts "+_(new Date(t.event.startDate)),1),o("h5",null,_(t.event.capacity)+" spots remaining",1),o("h5",null,"Located at "+_(t.event.location),1),t.event.capacity===0?(m(),v("h5",Ne,"No Capacity")):T("",!0),t.event.isCanceled?(m(),v("h5",De,"Event Canceled")):T("",!0)])}var Ve=w(Pe,[["render",Re],["__scopeId","data-v-3593fa2c"]]),$e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ve});const Le="modulepreload",L={},qe="/",A=function(e,t){return!t||t.length===0?e():Promise.all(t.map(n=>{if(n=`${qe}${n}`,n in L)return;L[n]=!0;const s=n.endsWith(".css"),c=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${c}`))return;const r=document.createElement("link");if(r.rel=s?"stylesheet":Le,s||(r.as="script",r.crossOrigin=""),r.href=n,document.head.appendChild(r),s)return new Promise((b,f)=>{r.addEventListener("load",b),r.addEventListener("error",f)})})).then(()=>e())};function Ue(a){switch(a){case"./pages/AboutPage.vue":return A(()=>import("./AboutPage.c4bd45d5.js"),["assets/AboutPage.c4bd45d5.js","assets/vendor.e9603ee6.js"]);case"./pages/AccountPage.vue":return A(()=>import("./AccountPage.d6321501.js"),["assets/AccountPage.d6321501.js","assets/AccountPage.7725de1d.css","assets/vendor.e9603ee6.js"]);case"./pages/EventPage.vue":return A(()=>import("./EventPage.bdb8e5ba.js"),["assets/EventPage.bdb8e5ba.js","assets/vendor.e9603ee6.js"]);case"./pages/HomePage.vue":return A(()=>import("./HomePage.a6fce5b9.js"),["assets/HomePage.a6fce5b9.js","assets/vendor.e9603ee6.js"]);default:return new Promise(function(e,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+a)))})}}function S(a){return()=>Ue(`./pages/${a}.vue`)}const je=[{path:"/",name:"Home",component:S("HomePage"),beforeEnter:D},{path:"/event/:eventId",name:"Event",component:S("EventPage"),beforeEnter:D},{path:"/about",name:"About",component:S("AboutPage")},{path:"/account",name:"Account",component:S("AccountPage"),beforeEnter:W}],q=z({linkActiveClass:"router-link-active",linkExactActiveClass:"router-link-exact-active",history:Y(),routes:je});class He{async getAccount(){try{const e=await d.get("/account");i.account=e.data}catch(e){l.error("HAVE YOU STARTED YOUR SERVER YET???",e)}}}const Me=new He,Be={connection:"connection",connected:"connected",disconnect:"disconnect",authenticate:"authenticate",authenticated:"authenticated",userConnected:"userConnected",userDisconnected:"userDisconnected",error:"error"};class Ke{constructor(e=!1,t=$){}on(e,t){var n;return(n=this.socket)==null||n.on(e,t.bind(this)),this}onConnected(e){l.log("[SOCKET_CONNECTION]",e),this.connected=!0,this.playback()}onAuthenticated(e){l.log("[SOCKET_AUTHENTICATED]",e),this.authenticated=!0,this.playback()}authenticate(e){var t;(t=this.socket)==null||t.emit(Be.authenticate,e)}onError(e){l.error("[SOCKET_ERROR]",e)}enqueue(e,t){l.log("[ENQUEING_ACTION]",{action:e,payload:t}),this.queue.push({action:e,payload:t})}playback(){l.log("[SOCKET_PLAYBACK]");const e=[...this.queue];this.queue=[],e.forEach(t=>{this.emit(t.action,t.payload)})}emit(e,t=void 0){if(this.requiresAuth&&!this.authenticated)return this.enqueue(e,t);if(!this.connected)return this.enqueue(e,t);this.socket.emit(e,t)}}class ze extends Ke{constructor(){super();this.on("error",this.onError)}onError(e){h.toast(e.message,"error")}}const U=new ze,u=F({domain:oe,clientId:ae,audience:se,useRefreshTokens:!0,onRedirectCallback:a=>{q.push(a&&a.targetUrl?a.targetUrl:window.location.pathname)}});u.on(u.AUTH_EVENTS.AUTHENTICATED,async function(){d.defaults.headers.authorization=u.bearer,d.interceptors.request.use(Ye),i.user=u.user,await Me.getAccount(),U.authenticate(u.bearer)});async function Ye(a){if(!u.isAuthenticated)return a;const e=u.identity.exp*1e3,t=e<Date.now(),n=e<Date.now()+1e3*60*60*12;return t?await u.loginWithPopup():n&&(await u.getTokenSilently(),d.defaults.headers.authorization=u.bearer,U.authenticate(u.bearer)),a}const We={setup(){return{user:y(()=>i.user),async login(){u.loginWithPopup()},async logout(){u.logout({returnTo:window.location.origin})}}}},k=a=>(G("data-v-6ea539d2"),a=a(),Q(),a),Fe={class:"navbar navbar-expand-lg navbar-dark bg-dark px-3"},Ge=k(()=>o("h1",{class:"me-3"},"Events",-1)),Qe=k(()=>o("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarText","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation"},[o("span",{class:"navbar-toggler-icon"})],-1)),Xe={class:"collapse navbar-collapse",id:"navbarText"},Je={class:"navbar-nav me-auto"},Ze={class:""},et={class:"navbar-text"},tt={key:1,class:"dropdown my-2 my-lg-0"},nt={class:"dropdown-toggle selectable","data-bs-toggle":"dropdown","aria-expanded":"false",id:"authDropdown"},ot=["src"],at={class:"mx-3 text-success lighten-30"},st={class:"dropdown-menu p-0 list-group w-100","aria-labelledby":"authDropdown"},rt=k(()=>o("div",{class:"list-group-item list-group-item-action hoverable"}," Manage Account ",-1)),ct=k(()=>o("i",{class:"mdi mdi-logout"},null,-1)),it=O(" logout "),lt=[ct,it];function dt(a,e,t,n,s,c){const r=x("router-link"),b=x("CreateEvent");return m(),v("nav",Fe,[E(r,{class:"navbar-brand d-flex",to:{name:"Home"}},{default:R(()=>[Ge]),_:1}),Qe,o("div",Xe,[o("ul",Je,[o("li",null,[o("h4",Ze,[E(b)])])]),o("span",et,[n.user.isAuthenticated?(m(),v("div",tt,[o("div",nt,[o("img",{src:n.user.picture,alt:"user photo",height:"40",class:"rounded"},null,8,ot),o("span",at,_(n.user.name),1)]),o("div",st,[E(r,{to:{name:"Account"}},{default:R(()=>[rt]),_:1}),o("div",{class:"list-group-item list-group-item-action hoverable text-danger",onClick:e[1]||(e[1]=(...f)=>n.logout&&n.logout(...f))},lt)])])):(m(),v("button",{key:0,class:"btn selectable text-success lighten-30 text-uppercase my-2 my-lg-0",onClick:e[0]||(e[0]=(...f)=>n.login&&n.login(...f))}," Login "))])])])}var ut=w(We,[["render",dt],["__scopeId","data-v-6ea539d2"]]),mt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:ut});function vt(a){Object.entries({"./components/Comment.vue":ve,"./components/CreateEvent.vue":Te,"./components/Event.vue":$e,"./components/Navbar.vue":mt}).forEach(([t,n])=>{const s=n.name||t.substr(t.lastIndexOf("/")+1).replace(/\.\w+$/,"");a.component(s,n.default)})}const j=X(ne);vt(j);j.use(q).mount("#app");export{i as A,h as P,w as _,d as a,ce as c,pe as e,l,q as r};
